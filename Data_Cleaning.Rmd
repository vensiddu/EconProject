---
title: "Data_cleaning"
output: html_document
date: "2024-04-26"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
Packages <- c("ggplot2", "dplyr", "stargazer")
lapply(Packages, library, character.only = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
wtk_site_metadata <- read.csv("C:/Users/koppa/OneDrive/Desktop/GroupProject/wtk_site_metadata.csv")
Sum <- summary(wtk_site_metadata)
latex_code <- xtable(Sum, caption = "Summary Statistics of wtk_site_metadata")
print(latex_code, caption.placement = "top")
```

```{r}
filtered_data <- wtk_site_metadata[wtk_site_metadata$County != "Unknown", ]
filtered_data <- filtered_data[filtered_data$State != "Unknown", ]
```

```{r}
aggregated_data <- filtered_data %>%
  group_by(State, County) %>%
  summarise(across(c( fraction_of_usable_area, capacity, wind_speed, capacity_factor), mean))
```

```{r}
Sum <- summary(aggregated_data[ -which(names(aggregated_data) == '')
latex_code <- xtable(Sum, caption = "Summary Statistics of wtk_site_metadata")
print(latex_code, caption.placement = "top")
```


```{r}
###  1. Wind turbine data
wind_turbine_data <- read.csv("uswtdb_v6_0_20230531.csv")
wind_turbine_main <- wind_turbine_data[complete.cases(wind_turbine_data[, c("eia_id", "p_year", "p_cap", "t_manu", "t_model", "t_cap", "t_hh", "t_rd", "xlong", "ylat")]),]
wind_turbine_main <- wind_turbine_main[which(wind_turbine_main$p_year >= 2001),]
wind_turbine_main <- wind_turbine_main[which(!wind_turbine_main$t_state %in% c("AK", "HI")),]

# convert turbine capacity in MWs
wind_turbine_main$t_cap <- wind_turbine_main$t_cap/1000

# 6. Summary stats  
stargazer(wind_turbine_main[, c("t_cap", "t_hh", "t_rd")])

wind_project_data <- wind_turbine_main %>% dplyr::group_by(eia_id) %>% dplyr::summarise(p_cap = mean(p_cap), t_cap = mean(t_cap), operating_year = first(p_year),hub_ht = mean(t_hh), rotor_diam = mean(t_rd), t_manu = first(t_manu), turbines = n(),t_model = first(t_model), state = first(t_state), county = first(t_county))
wind_project_data <- as.data.frame(wind_project_data)
                                                        
```
^This is the data that we will use

